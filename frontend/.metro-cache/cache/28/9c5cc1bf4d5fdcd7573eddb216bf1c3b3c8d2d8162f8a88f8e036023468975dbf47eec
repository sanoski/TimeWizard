{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"./databaseWrapper","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"MUXmcyigDhda3+oXopwCcUAp8ZU=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":40},"end":{"line":2,"column":39,"index":79}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.migrateDataFromBackend = migrateDataFromBackend;\n  exports.checkMigrationNeeded = checkMigrationNeeded;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _databaseWrapper = require(_dependencyMap[1]);\n  var _expoConstants = require(_dependencyMap[2]);\n  var Constants = _interopDefault(_expoConstants);\n  var BACKEND_URL = Constants.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL || \"https://railroad-hours.preview.emergentagent.com\" || '';\n  function migrateDataFromBackend() {\n    return _migrateDataFromBackend.apply(this, arguments);\n  }\n  function _migrateDataFromBackend() {\n    _migrateDataFromBackend = (0, _asyncToGenerator.default)(function* () {\n      try {\n        console.log('üîÑ Starting data migration from backend...');\n\n        // Fetch all data from backend\n        var response = yield fetch(`${BACKEND_URL}/api/export`);\n        if (!response.ok) {\n          throw new Error(`Backend export failed: ${response.statusText}`);\n        }\n        var backendData = yield response.json();\n        console.log(`üì¶ Fetched ${backendData.time_entries?.length || 0} time entries`);\n        console.log(`üì¶ Fetched ${backendData.line_codes?.length || 0} line codes`);\n        console.log(`üì¶ Fetched ${backendData.settings?.length || 0} settings`);\n\n        // Import data into local database\n        yield _databaseWrapper.db.importData(backendData);\n        console.log('‚úÖ Migration completed successfully');\n        return {\n          success: true,\n          message: `Migrated ${backendData.time_entries?.length || 0} time entries from server`\n        };\n      } catch (error) {\n        console.error('‚ùå Migration failed:', error);\n        return {\n          success: false,\n          message: `Migration failed: ${error.message}`\n        };\n      }\n    });\n    return _migrateDataFromBackend.apply(this, arguments);\n  }\n  function checkMigrationNeeded() {\n    return _checkMigrationNeeded.apply(this, arguments);\n  }\n  function _checkMigrationNeeded() {\n    _checkMigrationNeeded = (0, _asyncToGenerator.default)(function* () {\n      try {\n        // Check if local database has any time entries\n        var entries = yield _databaseWrapper.db.getAllLines();\n\n        // If we have default lines but no custom data, migration might be needed\n        // This is a simple check - you might want to add more sophisticated logic\n        return entries.length <= 10; // Only default lines exist\n      } catch (error) {\n        console.error('Error checking migration status:', error);\n        return false;\n      }\n    });\n    return _checkMigrationNeeded.apply(this, arguments);\n  }\n});","lineCount":74,"map":[[12,2,6,0,"exports"],[12,9,6,0],[12,10,6,0,"migrateDataFromBackend"],[12,32,6,0],[12,35,6,0,"migrateDataFromBackend"],[12,57,6,0],[13,2,41,0,"exports"],[13,9,41,0],[13,10,41,0,"checkMigrationNeeded"],[13,30,41,0],[13,33,41,0,"checkMigrationNeeded"],[13,53,41,0],[14,2,53,1],[14,6,53,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,42,53,1],[14,45,53,1,"require"],[14,52,53,1],[14,53,53,1,"_dependencyMap"],[14,67,53,1],[15,2,53,1],[15,6,53,1,"_asyncToGenerator"],[15,23,53,1],[15,26,53,1,"_interopDefault"],[15,41,53,1],[15,42,53,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,78,53,1],[16,2,1,0],[16,6,1,0,"_databaseWrapper"],[16,22,1,0],[16,25,1,0,"require"],[16,32,1,0],[16,33,1,0,"_dependencyMap"],[16,47,1,0],[17,2,2,0],[17,6,2,0,"_expoConstants"],[17,20,2,0],[17,23,2,0,"require"],[17,30,2,0],[17,31,2,0,"_dependencyMap"],[17,45,2,0],[18,2,2,0],[18,6,2,0,"Constants"],[18,15,2,0],[18,18,2,0,"_interopDefault"],[18,33,2,0],[18,34,2,0,"_expoConstants"],[18,48,2,0],[19,2,4,0],[19,6,4,6,"BACKEND_URL"],[19,17,4,17],[19,20,4,20,"Constants"],[19,29,4,29],[19,30,4,29,"default"],[19,37,4,29],[19,38,4,30,"expoConfig"],[19,48,4,40],[19,50,4,42,"extra"],[19,55,4,47],[19,57,4,49,"EXPO_PUBLIC_BACKEND_URL"],[19,80,4,72],[19,134,4,111],[19,138,4,115],[19,140,4,117],[20,2,4,118],[20,11,6,22,"migrateDataFromBackend"],[20,33,6,44,"migrateDataFromBackend"],[20,34,6,44],[21,4,6,44],[21,11,6,44,"_migrateDataFromBackend"],[21,34,6,44],[21,35,6,44,"apply"],[21,40,6,44],[21,47,6,44,"arguments"],[21,56,6,44],[22,2,6,44],[23,2,6,44],[23,11,6,44,"_migrateDataFromBackend"],[23,35,6,44],[24,4,6,44,"_migrateDataFromBackend"],[24,27,6,44],[24,34,6,44,"_asyncToGenerator"],[24,51,6,44],[24,52,6,44,"default"],[24,59,6,44],[24,61,6,7],[24,74,6,95],[25,6,7,2],[25,10,7,6],[26,8,8,4,"console"],[26,15,8,11],[26,16,8,12,"log"],[26,19,8,15],[26,20,8,16],[26,64,8,60],[26,65,8,61],[28,8,10,4],[29,8,11,4],[29,12,11,10,"response"],[29,20,11,18],[29,29,11,27,"fetch"],[29,34,11,32],[29,35,11,33],[29,38,11,36,"BACKEND_URL"],[29,49,11,47],[29,62,11,60],[29,63,11,61],[30,8,13,4],[30,12,13,8],[30,13,13,9,"response"],[30,21,13,17],[30,22,13,18,"ok"],[30,24,13,20],[30,26,13,22],[31,10,14,6],[31,16,14,12],[31,20,14,16,"Error"],[31,25,14,21],[31,26,14,22],[31,52,14,48,"response"],[31,60,14,56],[31,61,14,57,"statusText"],[31,71,14,67],[31,73,14,69],[31,74,14,70],[32,8,15,4],[33,8,17,4],[33,12,17,10,"backendData"],[33,23,17,21],[33,32,17,30,"response"],[33,40,17,38],[33,41,17,39,"json"],[33,45,17,43],[33,46,17,44],[33,47,17,45],[34,8,19,4,"console"],[34,15,19,11],[34,16,19,12,"log"],[34,19,19,15],[34,20,19,16],[34,34,19,30,"backendData"],[34,45,19,41],[34,46,19,42,"time_entries"],[34,58,19,54],[34,60,19,56,"length"],[34,66,19,62],[34,70,19,66],[34,71,19,67],[34,86,19,82],[34,87,19,83],[35,8,20,4,"console"],[35,15,20,11],[35,16,20,12,"log"],[35,19,20,15],[35,20,20,16],[35,34,20,30,"backendData"],[35,45,20,41],[35,46,20,42,"line_codes"],[35,56,20,52],[35,58,20,54,"length"],[35,64,20,60],[35,68,20,64],[35,69,20,65],[35,82,20,78],[35,83,20,79],[36,8,21,4,"console"],[36,15,21,11],[36,16,21,12,"log"],[36,19,21,15],[36,20,21,16],[36,34,21,30,"backendData"],[36,45,21,41],[36,46,21,42,"settings"],[36,54,21,50],[36,56,21,52,"length"],[36,62,21,58],[36,66,21,62],[36,67,21,63],[36,78,21,74],[36,79,21,75],[38,8,23,4],[39,8,24,4],[39,14,24,10,"db"],[39,30,24,12],[39,31,24,12,"db"],[39,33,24,12],[39,34,24,13,"importData"],[39,44,24,23],[39,45,24,24,"backendData"],[39,56,24,35],[39,57,24,36],[40,8,26,4,"console"],[40,15,26,11],[40,16,26,12,"log"],[40,19,26,15],[40,20,26,16],[40,56,26,52],[40,57,26,53],[41,8,28,4],[41,15,28,11],[42,10,29,6,"success"],[42,17,29,13],[42,19,29,15],[42,23,29,19],[43,10,30,6,"message"],[43,17,30,13],[43,19,30,15],[43,31,30,27,"backendData"],[43,42,30,38],[43,43,30,39,"time_entries"],[43,55,30,51],[43,57,30,53,"length"],[43,63,30,59],[43,67,30,63],[43,68,30,64],[44,8,31,4],[44,9,31,5],[45,6,32,2],[45,7,32,3],[45,8,32,4],[45,15,32,11,"error"],[45,20,32,16],[45,22,32,18],[46,8,33,4,"console"],[46,15,33,11],[46,16,33,12,"error"],[46,21,33,17],[46,22,33,18],[46,43,33,39],[46,45,33,41,"error"],[46,50,33,46],[46,51,33,47],[47,8,34,4],[47,15,34,11],[48,10,35,6,"success"],[48,17,35,13],[48,19,35,15],[48,24,35,20],[49,10,36,6,"message"],[49,17,36,13],[49,19,36,15],[49,40,36,36,"error"],[49,45,36,41],[49,46,36,42,"message"],[49,53,36,49],[50,8,37,4],[50,9,37,5],[51,6,38,2],[52,4,39,0],[52,5,39,1],[53,4,39,1],[53,11,39,1,"_migrateDataFromBackend"],[53,34,39,1],[53,35,39,1,"apply"],[53,40,39,1],[53,47,39,1,"arguments"],[53,56,39,1],[54,2,39,1],[55,2,39,1],[55,11,41,22,"checkMigrationNeeded"],[55,31,41,42,"checkMigrationNeeded"],[55,32,41,42],[56,4,41,42],[56,11,41,42,"_checkMigrationNeeded"],[56,32,41,42],[56,33,41,42,"apply"],[56,38,41,42],[56,45,41,42,"arguments"],[56,54,41,42],[57,2,41,42],[58,2,41,42],[58,11,41,42,"_checkMigrationNeeded"],[58,33,41,42],[59,4,41,42,"_checkMigrationNeeded"],[59,25,41,42],[59,32,41,42,"_asyncToGenerator"],[59,49,41,42],[59,50,41,42,"default"],[59,57,41,42],[59,59,41,7],[59,72,41,63],[60,6,42,2],[60,10,42,6],[61,8,43,4],[62,8,44,4],[62,12,44,10,"entries"],[62,19,44,17],[62,28,44,26,"db"],[62,44,44,28],[62,45,44,28,"db"],[62,47,44,28],[62,48,44,29,"getAllLines"],[62,59,44,40],[62,60,44,41],[62,61,44,42],[64,8,46,4],[65,8,47,4],[66,8,48,4],[66,15,48,11,"entries"],[66,22,48,18],[66,23,48,19,"length"],[66,29,48,25],[66,33,48,29],[66,35,48,31],[66,36,48,32],[66,37,48,33],[67,6,49,2],[67,7,49,3],[67,8,49,4],[67,15,49,11,"error"],[67,20,49,16],[67,22,49,18],[68,8,50,4,"console"],[68,15,50,11],[68,16,50,12,"error"],[68,21,50,17],[68,22,50,18],[68,56,50,52],[68,58,50,54,"error"],[68,63,50,59],[68,64,50,60],[69,8,51,4],[69,15,51,11],[69,20,51,16],[70,6,52,2],[71,4,53,0],[71,5,53,1],[72,4,53,1],[72,11,53,1,"_checkMigrationNeeded"],[72,32,53,1],[72,33,53,1,"apply"],[72,38,53,1],[72,45,53,1,"arguments"],[72,54,53,1],[73,2,53,1],[74,0,53,1],[74,3]],"functionMap":{"names":["<global>","migrateDataFromBackend","checkMigrationNeeded"],"mappings":"AAA;OCK;CDiC;OEE;CFY"},"hasCjsExports":false},"type":"js/module"}]}